{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _helpers = require(\"./helpers\");\n\nvar _styles = require(\"./styles\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar MIN_ZOOM = 1;\nvar MAX_ZOOM = 3;\n\nvar Cropper = /*#__PURE__*/function (_React$Component) {\n  _inherits(Cropper, _React$Component);\n\n  function Cropper() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cropper);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cropper)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.media = null;\n    _this.container = null;\n    _this.containerRect = {};\n    _this.mediaSize = {\n      width: 0,\n      height: 0,\n      naturalWidth: 0,\n      naturalHeight: 0\n    };\n    _this.dragStartPosition = {\n      x: 0,\n      y: 0\n    };\n    _this.dragStartCrop = {\n      x: 0,\n      y: 0\n    };\n    _this.lastPinchDistance = 0;\n    _this.lastPinchRotation = 0;\n    _this.rafDragTimeout = null;\n    _this.rafPinchTimeout = null;\n    _this.state = {\n      cropSize: null,\n      hasWheelJustStarted: false\n    };\n\n    _this.preventZoomSafari = function (e) {\n      return e.preventDefault();\n    };\n\n    _this.cleanEvents = function () {\n      document.removeEventListener('mousemove', _this.onMouseMove);\n      document.removeEventListener('mouseup', _this.onDragStopped);\n      document.removeEventListener('touchmove', _this.onTouchMove);\n      document.removeEventListener('touchend', _this.onDragStopped);\n    };\n\n    _this.onMediaLoad = function () {\n      _this.computeSizes();\n\n      _this.emitCropData();\n\n      _this.setInitialCrop();\n\n      if (_this.props.onMediaLoaded) {\n        _this.props.onMediaLoaded(_this.mediaSize);\n      }\n      /* Deprecated */\n\n\n      if (_this.props.onImageLoaded) {\n        _this.props.onImageLoaded(_this.mediaSize);\n      }\n    };\n\n    _this.setInitialCrop = function () {\n      var _this$props = _this.props,\n          initialCroppedAreaPixels = _this$props.initialCroppedAreaPixels,\n          cropSize = _this$props.cropSize;\n\n      if (!initialCroppedAreaPixels) {\n        return;\n      }\n\n      var _getInitialCropFromCr = (0, _helpers.getInitialCropFromCroppedAreaPixels)(initialCroppedAreaPixels, _this.mediaSize, cropSize),\n          crop = _getInitialCropFromCr.crop,\n          zoom = _getInitialCropFromCr.zoom;\n\n      _this.props.onCropChange(crop);\n\n      _this.props.onZoomChange && _this.props.onZoomChange(zoom);\n    };\n\n    _this.computeSizes = function () {\n      if (_this.media) {\n        _this.mediaSize = {\n          width: _this.media.offsetWidth,\n          height: _this.media.offsetHeight,\n          naturalWidth: _this.media.naturalWidth || _this.media.videoWidth,\n          naturalHeight: _this.media.naturalHeight || _this.media.videoHeight\n        };\n        var cropSize = _this.props.cropSize ? _this.props.cropSize : (0, _helpers.getCropSize)(_this.media.offsetWidth, _this.media.offsetHeight, _this.props.aspect, _this.props.rotation);\n\n        _this.setState({\n          cropSize: cropSize\n        }, _this.recomputeCropPosition);\n      }\n\n      if (_this.container) {\n        _this.containerRect = _this.container.getBoundingClientRect();\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      e.preventDefault();\n      document.addEventListener('mousemove', _this.onMouseMove);\n      document.addEventListener('mouseup', _this.onDragStopped);\n\n      _this.onDragStart(Cropper.getMousePoint(e));\n    };\n\n    _this.onMouseMove = function (e) {\n      return _this.onDrag(Cropper.getMousePoint(e));\n    };\n\n    _this.onTouchStart = function (e) {\n      e.preventDefault();\n      document.addEventListener('touchmove', _this.onTouchMove, {\n        passive: false\n      }); // iOS 11 now defaults to passive: true\n\n      document.addEventListener('touchend', _this.onDragStopped);\n\n      if (e.touches.length === 2) {\n        _this.onPinchStart(e);\n      } else if (e.touches.length === 1) {\n        _this.onDragStart(Cropper.getTouchPoint(e.touches[0]));\n      }\n    };\n\n    _this.onTouchMove = function (e) {\n      // Prevent whole page from scrolling on iOS.\n      e.preventDefault();\n\n      if (e.touches.length === 2) {\n        _this.onPinchMove(e);\n      } else if (e.touches.length === 1) {\n        _this.onDrag(Cropper.getTouchPoint(e.touches[0]));\n      }\n    };\n\n    _this.onDragStart = function (_ref) {\n      var x = _ref.x,\n          y = _ref.y;\n      _this.dragStartPosition = {\n        x: x,\n        y: y\n      };\n      _this.dragStartCrop = {\n        x: _this.props.crop.x,\n        y: _this.props.crop.y\n      };\n\n      _this.props.onInteractionStart();\n    };\n\n    _this.onDrag = function (_ref2) {\n      var x = _ref2.x,\n          y = _ref2.y;\n      if (!_this.state.cropSize) return;\n      if (_this.rafDragTimeout) window.cancelAnimationFrame(_this.rafDragTimeout);\n      _this.rafDragTimeout = window.requestAnimationFrame(function () {\n        if (x === undefined || y === undefined) return;\n        var offsetX = x - _this.dragStartPosition.x;\n        var offsetY = y - _this.dragStartPosition.y;\n        var requestedPosition = {\n          x: _this.dragStartCrop.x + offsetX,\n          y: _this.dragStartCrop.y + offsetY\n        };\n        var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(requestedPosition, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : requestedPosition;\n\n        _this.props.onCropChange(newPosition);\n      });\n    };\n\n    _this.onDragStopped = function () {\n      _this.cleanEvents();\n\n      _this.emitCropData();\n\n      _this.props.onInteractionEnd();\n    };\n\n    _this.onWheel = function (e) {\n      e.preventDefault();\n      var point = Cropper.getMousePoint(e);\n      var newZoom = _this.props.zoom - e.deltaY * _this.props.zoomSpeed / 200;\n\n      _this.setNewZoom(newZoom, point);\n\n      if (!_this.state.hasWheelJustStarted) {\n        _this.setState({\n          hasWheelJustStarted: true\n        }, function () {\n          return _this.props.onInteractionStart();\n        });\n      }\n\n      clearTimeout(_this.wheelTimer);\n      _this.wheelTimer = setTimeout(function () {\n        return _this.setState({\n          hasWheelJustStarted: false\n        }, function () {\n          return _this.props.onInteractionEnd();\n        });\n      }, 250);\n    };\n\n    _this.getPointOnContainer = function (_ref3, zoom) {\n      var x = _ref3.x,\n          y = _ref3.y;\n\n      if (!_this.containerRect) {\n        throw new Error('The Cropper is not mounted');\n      }\n\n      return {\n        x: _this.containerRect.width / 2 - (x - _this.containerRect.left),\n        y: _this.containerRect.height / 2 - (y - _this.containerRect.top)\n      };\n    };\n\n    _this.getPointOnMedia = function (_ref4) {\n      var x = _ref4.x,\n          y = _ref4.y;\n      var _this$props2 = _this.props,\n          crop = _this$props2.crop,\n          zoom = _this$props2.zoom;\n      return {\n        x: (x + crop.x) / zoom,\n        y: (y + crop.y) / zoom\n      };\n    };\n\n    _this.setNewZoom = function (zoom, point) {\n      if (!_this.state.cropSize || !_this.props.onZoomChange) return;\n\n      var zoomPoint = _this.getPointOnContainer(point);\n\n      var zoomTarget = _this.getPointOnMedia(zoomPoint);\n\n      var newZoom = Math.min(_this.props.maxZoom, Math.max(zoom, _this.props.minZoom));\n      var requestedPosition = {\n        x: zoomTarget.x * newZoom - zoomPoint.x,\n        y: zoomTarget.y * newZoom - zoomPoint.y\n      };\n      var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(requestedPosition, _this.mediaSize, _this.state.cropSize, newZoom, _this.props.rotation) : requestedPosition;\n\n      _this.props.onCropChange(newPosition);\n\n      _this.props.onZoomChange(newZoom);\n    };\n\n    _this.emitCropData = function () {\n      if (!_this.state.cropSize) return; // this is to ensure the crop is correctly restricted after a zoom back (https://github.com/ricardo-ch/react-easy-crop/issues/6)\n\n      var restrictedPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(_this.props.crop, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : _this.props.crop;\n\n      var _computeCroppedArea = (0, _helpers.computeCroppedArea)(restrictedPosition, _this.mediaSize, _this.state.cropSize, _this.getAspect(), _this.props.zoom, _this.props.rotation, _this.props.restrictPosition),\n          croppedAreaPercentages = _computeCroppedArea.croppedAreaPercentages,\n          croppedAreaPixels = _computeCroppedArea.croppedAreaPixels;\n\n      _this.props.onCropComplete && _this.props.onCropComplete(croppedAreaPercentages, croppedAreaPixels);\n    };\n\n    _this.recomputeCropPosition = function () {\n      var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(_this.props.crop, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : _this.props.crop;\n\n      _this.props.onCropChange(newPosition);\n\n      _this.emitCropData();\n    };\n\n    return _this;\n  }\n\n  _createClass(Cropper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.computeSizes);\n      this.container.addEventListener('wheel', this.onWheel, {\n        passive: false\n      });\n      this.container.addEventListener('gesturestart', this.preventZoomSafari);\n      this.container.addEventListener('gesturechange', this.preventZoomSafari); // when rendered via SSR, the media can already be loaded and its onLoad callback will never be called\n\n      if (this.media && this.media.complete) {\n        this.onMediaLoad();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.computeSizes);\n      this.container.removeEventListener('wheel', this.onWheel);\n      this.container.removeEventListener('gesturestart', this.preventZoomSafari);\n      this.container.removeEventListener('gesturechange', this.preventZoomSafari);\n      this.cleanEvents();\n      clearTimeout(this.wheelTimer);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.rotation !== this.props.rotation) {\n        this.computeSizes();\n        this.recomputeCropPosition();\n      } else if (prevProps.aspect !== this.props.aspect) {\n        this.computeSizes();\n      } else if (prevProps.zoom !== this.props.zoom) {\n        this.recomputeCropPosition();\n      }\n    } // this is to prevent Safari on iOS >= 10 to zoom the page\n\n  }, {\n    key: \"getAspect\",\n    value: function getAspect() {\n      var _this$props3 = this.props,\n          cropSize = _this$props3.cropSize,\n          aspect = _this$props3.aspect;\n\n      if (cropSize) {\n        return cropSize.width / cropSize.height;\n      }\n\n      return aspect;\n    }\n  }, {\n    key: \"onPinchStart\",\n    value: function onPinchStart(e) {\n      var pointA = Cropper.getTouchPoint(e.touches[0]);\n      var pointB = Cropper.getTouchPoint(e.touches[1]);\n      this.lastPinchDistance = (0, _helpers.getDistanceBetweenPoints)(pointA, pointB);\n      this.lastPinchRotation = (0, _helpers.getRotationBetweenPoints)(pointA, pointB);\n      this.onDragStart((0, _helpers.getCenter)(pointA, pointB));\n    }\n  }, {\n    key: \"onPinchMove\",\n    value: function onPinchMove(e) {\n      var _this2 = this;\n\n      var pointA = Cropper.getTouchPoint(e.touches[0]);\n      var pointB = Cropper.getTouchPoint(e.touches[1]);\n      var center = (0, _helpers.getCenter)(pointA, pointB);\n      this.onDrag(center);\n      if (this.rafPinchTimeout) window.cancelAnimationFrame(this.rafPinchTimeout);\n      this.rafPinchTimeout = window.requestAnimationFrame(function () {\n        var distance = (0, _helpers.getDistanceBetweenPoints)(pointA, pointB);\n        var newZoom = _this2.props.zoom * (distance / _this2.lastPinchDistance);\n\n        _this2.setNewZoom(newZoom, center);\n\n        _this2.lastPinchDistance = distance;\n        var rotation = (0, _helpers.getRotationBetweenPoints)(pointA, pointB);\n        var newRotation = _this2.props.rotation + (rotation - _this2.lastPinchRotation);\n        _this2.props.onRotationChange && _this2.props.onRotationChange(newRotation);\n        _this2.lastPinchRotation = rotation;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props4 = this.props,\n          image = _this$props4.image,\n          video = _this$props4.video,\n          mediaProps = _this$props4.mediaProps,\n          _this$props4$crop = _this$props4.crop,\n          x = _this$props4$crop.x,\n          y = _this$props4$crop.y,\n          rotation = _this$props4.rotation,\n          zoom = _this$props4.zoom,\n          cropShape = _this$props4.cropShape,\n          showGrid = _this$props4.showGrid,\n          _this$props4$style = _this$props4.style,\n          containerStyle = _this$props4$style.containerStyle,\n          cropAreaStyle = _this$props4$style.cropAreaStyle,\n          mediaStyle = _this$props4$style.mediaStyle,\n          imageStyle = _this$props4$style.imageStyle,\n          _this$props4$classes = _this$props4.classes,\n          containerClassName = _this$props4$classes.containerClassName,\n          cropAreaClassName = _this$props4$classes.cropAreaClassName,\n          mediaClassName = _this$props4$classes.mediaClassName,\n          imageClassName = _this$props4$classes.imageClassName,\n          crossOrigin = _this$props4.crossOrigin; // imageStyle and imageClassName are deprecated\n\n      return _react[\"default\"].createElement(_styles.Container, {\n        onMouseDown: this.onMouseDown,\n        onTouchStart: this.onTouchStart,\n        ref: function ref(el) {\n          return _this3.container = el;\n        },\n        \"data-testid\": \"container\",\n        containerStyle: containerStyle,\n        className: containerClassName\n      }, image ? _react[\"default\"].createElement(_styles.Img, _extends({\n        src: image,\n        ref: function ref(el) {\n          return _this3.media = el;\n        },\n        onLoad: this.onMediaLoad,\n        onError: this.props.onMediaError || this.props.onImgError,\n        alt: \"\",\n        style: {\n          transform: \"translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"deg) scale(\").concat(zoom, \")\")\n        },\n        mediaStyle: mediaStyle || imageStyle,\n        className: mediaClassName || imageClassName,\n        crossOrigin: crossOrigin\n      }, mediaProps)) : video && _react[\"default\"].createElement(_styles.Video, _extends({\n        autoPlay: true,\n        loop: true,\n        muted: true,\n        src: video,\n        ref: function ref(el) {\n          return _this3.media = el;\n        },\n        onLoadedMetadata: this.onMediaLoad,\n        onError: this.props.onMediaError,\n        alt: \"\",\n        style: {\n          transform: \"translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"deg) scale(\").concat(zoom, \")\")\n        },\n        mediaStyle: mediaStyle || imageStyle,\n        className: mediaClassName || imageClassName,\n        crossOrigin: crossOrigin\n      }, mediaProps, {\n        controls: false\n      })), this.state.cropSize && _react[\"default\"].createElement(_styles.CropArea, {\n        cropShape: cropShape,\n        showGrid: showGrid,\n        style: {\n          width: this.state.cropSize.width,\n          height: this.state.cropSize.height\n        },\n        \"data-testid\": \"cropper\",\n        cropAreaStyle: cropAreaStyle,\n        className: cropAreaClassName\n      }));\n    }\n  }]);\n\n  return Cropper;\n}(_react[\"default\"].Component);\n\nCropper.getMousePoint = function (e) {\n  return {\n    x: Number(e.clientX),\n    y: Number(e.clientY)\n  };\n};\n\nCropper.getTouchPoint = function (touch) {\n  return {\n    x: Number(touch.clientX),\n    y: Number(touch.clientY)\n  };\n};\n\nCropper.defaultProps = {\n  zoom: 1,\n  rotation: 0,\n  aspect: 4 / 3,\n  maxZoom: MAX_ZOOM,\n  minZoom: MIN_ZOOM,\n  cropShape: 'rect',\n  showGrid: true,\n  style: {},\n  classes: {},\n  mediaProps: {},\n  zoomSpeed: 1,\n  crossOrigin: undefined,\n  restrictPosition: true,\n  onInteractionStart: function onInteractionStart() {},\n  onInteractionEnd: function onInteractionEnd() {}\n};\nvar _default = Cropper;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/usr/app/node_modules/react-bootstrap-image-cropper/node_modules/react-easy-crop/dist/index.js"],"names":["Object","defineProperty","exports","value","_react","_interopRequireDefault","require","_helpers","_styles","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_extends","assign","target","i","arguments","length","source","key","hasOwnProperty","call","apply","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","MIN_ZOOM","MAX_ZOOM","Cropper","_React$Component","_getPrototypeOf2","_this","_len","args","Array","_key","concat","media","container","containerRect","mediaSize","width","height","naturalWidth","naturalHeight","dragStartPosition","x","y","dragStartCrop","lastPinchDistance","lastPinchRotation","rafDragTimeout","rafPinchTimeout","state","cropSize","hasWheelJustStarted","preventZoomSafari","e","preventDefault","cleanEvents","document","removeEventListener","onMouseMove","onDragStopped","onTouchMove","onMediaLoad","computeSizes","emitCropData","setInitialCrop","onMediaLoaded","onImageLoaded","_this$props","initialCroppedAreaPixels","_getInitialCropFromCr","getInitialCropFromCroppedAreaPixels","crop","zoom","onCropChange","onZoomChange","offsetWidth","offsetHeight","videoWidth","videoHeight","getCropSize","aspect","rotation","setState","recomputeCropPosition","getBoundingClientRect","onMouseDown","addEventListener","onDragStart","getMousePoint","onDrag","onTouchStart","passive","touches","onPinchStart","getTouchPoint","onPinchMove","_ref","onInteractionStart","_ref2","window","cancelAnimationFrame","requestAnimationFrame","undefined","offsetX","offsetY","requestedPosition","newPosition","restrictPosition","onInteractionEnd","onWheel","point","newZoom","deltaY","zoomSpeed","setNewZoom","clearTimeout","wheelTimer","setTimeout","getPointOnContainer","_ref3","Error","left","top","getPointOnMedia","_ref4","_this$props2","zoomPoint","zoomTarget","Math","min","maxZoom","max","minZoom","restrictedPosition","_computeCroppedArea","computeCroppedArea","getAspect","croppedAreaPercentages","croppedAreaPixels","onCropComplete","componentDidMount","complete","componentWillUnmount","componentDidUpdate","prevProps","_this$props3","pointA","pointB","getDistanceBetweenPoints","getRotationBetweenPoints","getCenter","_this2","center","distance","newRotation","onRotationChange","render","_this3","_this$props4","image","video","mediaProps","_this$props4$crop","cropShape","showGrid","_this$props4$style","style","containerStyle","cropAreaStyle","mediaStyle","imageStyle","_this$props4$classes","classes","containerClassName","cropAreaClassName","mediaClassName","imageClassName","crossOrigin","createElement","Container","ref","el","className","Img","src","onLoad","onError","onMediaError","onImgError","alt","transform","Video","autoPlay","loop","muted","onLoadedMetadata","controls","CropArea","Component","Number","clientX","clientY","touch","defaultProps","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _helpers = require(\"./helpers\");\n\nvar _styles = require(\"./styles\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar MIN_ZOOM = 1;\nvar MAX_ZOOM = 3;\n\nvar Cropper =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Cropper, _React$Component);\n\n  function Cropper() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cropper);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cropper)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.media = null;\n    _this.container = null;\n    _this.containerRect = {};\n    _this.mediaSize = {\n      width: 0,\n      height: 0,\n      naturalWidth: 0,\n      naturalHeight: 0\n    };\n    _this.dragStartPosition = {\n      x: 0,\n      y: 0\n    };\n    _this.dragStartCrop = {\n      x: 0,\n      y: 0\n    };\n    _this.lastPinchDistance = 0;\n    _this.lastPinchRotation = 0;\n    _this.rafDragTimeout = null;\n    _this.rafPinchTimeout = null;\n    _this.state = {\n      cropSize: null,\n      hasWheelJustStarted: false\n    };\n\n    _this.preventZoomSafari = function (e) {\n      return e.preventDefault();\n    };\n\n    _this.cleanEvents = function () {\n      document.removeEventListener('mousemove', _this.onMouseMove);\n      document.removeEventListener('mouseup', _this.onDragStopped);\n      document.removeEventListener('touchmove', _this.onTouchMove);\n      document.removeEventListener('touchend', _this.onDragStopped);\n    };\n\n    _this.onMediaLoad = function () {\n      _this.computeSizes();\n\n      _this.emitCropData();\n\n      _this.setInitialCrop();\n\n      if (_this.props.onMediaLoaded) {\n        _this.props.onMediaLoaded(_this.mediaSize);\n      }\n      /* Deprecated */\n\n\n      if (_this.props.onImageLoaded) {\n        _this.props.onImageLoaded(_this.mediaSize);\n      }\n    };\n\n    _this.setInitialCrop = function () {\n      var _this$props = _this.props,\n          initialCroppedAreaPixels = _this$props.initialCroppedAreaPixels,\n          cropSize = _this$props.cropSize;\n\n      if (!initialCroppedAreaPixels) {\n        return;\n      }\n\n      var _getInitialCropFromCr = (0, _helpers.getInitialCropFromCroppedAreaPixels)(initialCroppedAreaPixels, _this.mediaSize, cropSize),\n          crop = _getInitialCropFromCr.crop,\n          zoom = _getInitialCropFromCr.zoom;\n\n      _this.props.onCropChange(crop);\n\n      _this.props.onZoomChange && _this.props.onZoomChange(zoom);\n    };\n\n    _this.computeSizes = function () {\n      if (_this.media) {\n        _this.mediaSize = {\n          width: _this.media.offsetWidth,\n          height: _this.media.offsetHeight,\n          naturalWidth: _this.media.naturalWidth || _this.media.videoWidth,\n          naturalHeight: _this.media.naturalHeight || _this.media.videoHeight\n        };\n        var cropSize = _this.props.cropSize ? _this.props.cropSize : (0, _helpers.getCropSize)(_this.media.offsetWidth, _this.media.offsetHeight, _this.props.aspect, _this.props.rotation);\n\n        _this.setState({\n          cropSize: cropSize\n        }, _this.recomputeCropPosition);\n      }\n\n      if (_this.container) {\n        _this.containerRect = _this.container.getBoundingClientRect();\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      e.preventDefault();\n      document.addEventListener('mousemove', _this.onMouseMove);\n      document.addEventListener('mouseup', _this.onDragStopped);\n\n      _this.onDragStart(Cropper.getMousePoint(e));\n    };\n\n    _this.onMouseMove = function (e) {\n      return _this.onDrag(Cropper.getMousePoint(e));\n    };\n\n    _this.onTouchStart = function (e) {\n      e.preventDefault();\n      document.addEventListener('touchmove', _this.onTouchMove, {\n        passive: false\n      }); // iOS 11 now defaults to passive: true\n\n      document.addEventListener('touchend', _this.onDragStopped);\n\n      if (e.touches.length === 2) {\n        _this.onPinchStart(e);\n      } else if (e.touches.length === 1) {\n        _this.onDragStart(Cropper.getTouchPoint(e.touches[0]));\n      }\n    };\n\n    _this.onTouchMove = function (e) {\n      // Prevent whole page from scrolling on iOS.\n      e.preventDefault();\n\n      if (e.touches.length === 2) {\n        _this.onPinchMove(e);\n      } else if (e.touches.length === 1) {\n        _this.onDrag(Cropper.getTouchPoint(e.touches[0]));\n      }\n    };\n\n    _this.onDragStart = function (_ref) {\n      var x = _ref.x,\n          y = _ref.y;\n      _this.dragStartPosition = {\n        x: x,\n        y: y\n      };\n      _this.dragStartCrop = {\n        x: _this.props.crop.x,\n        y: _this.props.crop.y\n      };\n\n      _this.props.onInteractionStart();\n    };\n\n    _this.onDrag = function (_ref2) {\n      var x = _ref2.x,\n          y = _ref2.y;\n      if (!_this.state.cropSize) return;\n      if (_this.rafDragTimeout) window.cancelAnimationFrame(_this.rafDragTimeout);\n      _this.rafDragTimeout = window.requestAnimationFrame(function () {\n        if (x === undefined || y === undefined) return;\n        var offsetX = x - _this.dragStartPosition.x;\n        var offsetY = y - _this.dragStartPosition.y;\n        var requestedPosition = {\n          x: _this.dragStartCrop.x + offsetX,\n          y: _this.dragStartCrop.y + offsetY\n        };\n        var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(requestedPosition, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : requestedPosition;\n\n        _this.props.onCropChange(newPosition);\n      });\n    };\n\n    _this.onDragStopped = function () {\n      _this.cleanEvents();\n\n      _this.emitCropData();\n\n      _this.props.onInteractionEnd();\n    };\n\n    _this.onWheel = function (e) {\n      e.preventDefault();\n      var point = Cropper.getMousePoint(e);\n      var newZoom = _this.props.zoom - e.deltaY * _this.props.zoomSpeed / 200;\n\n      _this.setNewZoom(newZoom, point);\n\n      if (!_this.state.hasWheelJustStarted) {\n        _this.setState({\n          hasWheelJustStarted: true\n        }, function () {\n          return _this.props.onInteractionStart();\n        });\n      }\n\n      clearTimeout(_this.wheelTimer);\n      _this.wheelTimer = setTimeout(function () {\n        return _this.setState({\n          hasWheelJustStarted: false\n        }, function () {\n          return _this.props.onInteractionEnd();\n        });\n      }, 250);\n    };\n\n    _this.getPointOnContainer = function (_ref3, zoom) {\n      var x = _ref3.x,\n          y = _ref3.y;\n\n      if (!_this.containerRect) {\n        throw new Error('The Cropper is not mounted');\n      }\n\n      return {\n        x: _this.containerRect.width / 2 - (x - _this.containerRect.left),\n        y: _this.containerRect.height / 2 - (y - _this.containerRect.top)\n      };\n    };\n\n    _this.getPointOnMedia = function (_ref4) {\n      var x = _ref4.x,\n          y = _ref4.y;\n      var _this$props2 = _this.props,\n          crop = _this$props2.crop,\n          zoom = _this$props2.zoom;\n      return {\n        x: (x + crop.x) / zoom,\n        y: (y + crop.y) / zoom\n      };\n    };\n\n    _this.setNewZoom = function (zoom, point) {\n      if (!_this.state.cropSize || !_this.props.onZoomChange) return;\n\n      var zoomPoint = _this.getPointOnContainer(point);\n\n      var zoomTarget = _this.getPointOnMedia(zoomPoint);\n\n      var newZoom = Math.min(_this.props.maxZoom, Math.max(zoom, _this.props.minZoom));\n      var requestedPosition = {\n        x: zoomTarget.x * newZoom - zoomPoint.x,\n        y: zoomTarget.y * newZoom - zoomPoint.y\n      };\n      var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(requestedPosition, _this.mediaSize, _this.state.cropSize, newZoom, _this.props.rotation) : requestedPosition;\n\n      _this.props.onCropChange(newPosition);\n\n      _this.props.onZoomChange(newZoom);\n    };\n\n    _this.emitCropData = function () {\n      if (!_this.state.cropSize) return; // this is to ensure the crop is correctly restricted after a zoom back (https://github.com/ricardo-ch/react-easy-crop/issues/6)\n\n      var restrictedPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(_this.props.crop, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : _this.props.crop;\n\n      var _computeCroppedArea = (0, _helpers.computeCroppedArea)(restrictedPosition, _this.mediaSize, _this.state.cropSize, _this.getAspect(), _this.props.zoom, _this.props.rotation, _this.props.restrictPosition),\n          croppedAreaPercentages = _computeCroppedArea.croppedAreaPercentages,\n          croppedAreaPixels = _computeCroppedArea.croppedAreaPixels;\n\n      _this.props.onCropComplete && _this.props.onCropComplete(croppedAreaPercentages, croppedAreaPixels);\n    };\n\n    _this.recomputeCropPosition = function () {\n      var newPosition = _this.props.restrictPosition ? (0, _helpers.restrictPosition)(_this.props.crop, _this.mediaSize, _this.state.cropSize, _this.props.zoom, _this.props.rotation) : _this.props.crop;\n\n      _this.props.onCropChange(newPosition);\n\n      _this.emitCropData();\n    };\n\n    return _this;\n  }\n\n  _createClass(Cropper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.computeSizes);\n      this.container.addEventListener('wheel', this.onWheel, {\n        passive: false\n      });\n      this.container.addEventListener('gesturestart', this.preventZoomSafari);\n      this.container.addEventListener('gesturechange', this.preventZoomSafari); // when rendered via SSR, the media can already be loaded and its onLoad callback will never be called\n\n      if (this.media && this.media.complete) {\n        this.onMediaLoad();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.computeSizes);\n      this.container.removeEventListener('wheel', this.onWheel);\n      this.container.removeEventListener('gesturestart', this.preventZoomSafari);\n      this.container.removeEventListener('gesturechange', this.preventZoomSafari);\n      this.cleanEvents();\n      clearTimeout(this.wheelTimer);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.rotation !== this.props.rotation) {\n        this.computeSizes();\n        this.recomputeCropPosition();\n      } else if (prevProps.aspect !== this.props.aspect) {\n        this.computeSizes();\n      } else if (prevProps.zoom !== this.props.zoom) {\n        this.recomputeCropPosition();\n      }\n    } // this is to prevent Safari on iOS >= 10 to zoom the page\n\n  }, {\n    key: \"getAspect\",\n    value: function getAspect() {\n      var _this$props3 = this.props,\n          cropSize = _this$props3.cropSize,\n          aspect = _this$props3.aspect;\n\n      if (cropSize) {\n        return cropSize.width / cropSize.height;\n      }\n\n      return aspect;\n    }\n  }, {\n    key: \"onPinchStart\",\n    value: function onPinchStart(e) {\n      var pointA = Cropper.getTouchPoint(e.touches[0]);\n      var pointB = Cropper.getTouchPoint(e.touches[1]);\n      this.lastPinchDistance = (0, _helpers.getDistanceBetweenPoints)(pointA, pointB);\n      this.lastPinchRotation = (0, _helpers.getRotationBetweenPoints)(pointA, pointB);\n      this.onDragStart((0, _helpers.getCenter)(pointA, pointB));\n    }\n  }, {\n    key: \"onPinchMove\",\n    value: function onPinchMove(e) {\n      var _this2 = this;\n\n      var pointA = Cropper.getTouchPoint(e.touches[0]);\n      var pointB = Cropper.getTouchPoint(e.touches[1]);\n      var center = (0, _helpers.getCenter)(pointA, pointB);\n      this.onDrag(center);\n      if (this.rafPinchTimeout) window.cancelAnimationFrame(this.rafPinchTimeout);\n      this.rafPinchTimeout = window.requestAnimationFrame(function () {\n        var distance = (0, _helpers.getDistanceBetweenPoints)(pointA, pointB);\n        var newZoom = _this2.props.zoom * (distance / _this2.lastPinchDistance);\n\n        _this2.setNewZoom(newZoom, center);\n\n        _this2.lastPinchDistance = distance;\n        var rotation = (0, _helpers.getRotationBetweenPoints)(pointA, pointB);\n        var newRotation = _this2.props.rotation + (rotation - _this2.lastPinchRotation);\n        _this2.props.onRotationChange && _this2.props.onRotationChange(newRotation);\n        _this2.lastPinchRotation = rotation;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props4 = this.props,\n          image = _this$props4.image,\n          video = _this$props4.video,\n          mediaProps = _this$props4.mediaProps,\n          _this$props4$crop = _this$props4.crop,\n          x = _this$props4$crop.x,\n          y = _this$props4$crop.y,\n          rotation = _this$props4.rotation,\n          zoom = _this$props4.zoom,\n          cropShape = _this$props4.cropShape,\n          showGrid = _this$props4.showGrid,\n          _this$props4$style = _this$props4.style,\n          containerStyle = _this$props4$style.containerStyle,\n          cropAreaStyle = _this$props4$style.cropAreaStyle,\n          mediaStyle = _this$props4$style.mediaStyle,\n          imageStyle = _this$props4$style.imageStyle,\n          _this$props4$classes = _this$props4.classes,\n          containerClassName = _this$props4$classes.containerClassName,\n          cropAreaClassName = _this$props4$classes.cropAreaClassName,\n          mediaClassName = _this$props4$classes.mediaClassName,\n          imageClassName = _this$props4$classes.imageClassName,\n          crossOrigin = _this$props4.crossOrigin; // imageStyle and imageClassName are deprecated\n\n      return _react[\"default\"].createElement(_styles.Container, {\n        onMouseDown: this.onMouseDown,\n        onTouchStart: this.onTouchStart,\n        ref: function ref(el) {\n          return _this3.container = el;\n        },\n        \"data-testid\": \"container\",\n        containerStyle: containerStyle,\n        className: containerClassName\n      }, image ? _react[\"default\"].createElement(_styles.Img, _extends({\n        src: image,\n        ref: function ref(el) {\n          return _this3.media = el;\n        },\n        onLoad: this.onMediaLoad,\n        onError: this.props.onMediaError || this.props.onImgError,\n        alt: \"\",\n        style: {\n          transform: \"translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"deg) scale(\").concat(zoom, \")\")\n        },\n        mediaStyle: mediaStyle || imageStyle,\n        className: mediaClassName || imageClassName,\n        crossOrigin: crossOrigin\n      }, mediaProps)) : video && _react[\"default\"].createElement(_styles.Video, _extends({\n        autoPlay: true,\n        loop: true,\n        muted: true,\n        src: video,\n        ref: function ref(el) {\n          return _this3.media = el;\n        },\n        onLoadedMetadata: this.onMediaLoad,\n        onError: this.props.onMediaError,\n        alt: \"\",\n        style: {\n          transform: \"translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"deg) scale(\").concat(zoom, \")\")\n        },\n        mediaStyle: mediaStyle || imageStyle,\n        className: mediaClassName || imageClassName,\n        crossOrigin: crossOrigin\n      }, mediaProps, {\n        controls: false\n      })), this.state.cropSize && _react[\"default\"].createElement(_styles.CropArea, {\n        cropShape: cropShape,\n        showGrid: showGrid,\n        style: {\n          width: this.state.cropSize.width,\n          height: this.state.cropSize.height\n        },\n        \"data-testid\": \"cropper\",\n        cropAreaStyle: cropAreaStyle,\n        className: cropAreaClassName\n      }));\n    }\n  }]);\n\n  return Cropper;\n}(_react[\"default\"].Component);\n\nCropper.getMousePoint = function (e) {\n  return {\n    x: Number(e.clientX),\n    y: Number(e.clientY)\n  };\n};\n\nCropper.getTouchPoint = function (touch) {\n  return {\n    x: Number(touch.clientX),\n    y: Number(touch.clientY)\n  };\n};\n\nCropper.defaultProps = {\n  zoom: 1,\n  rotation: 0,\n  aspect: 4 / 3,\n  maxZoom: MAX_ZOOM,\n  minZoom: MIN_ZOOM,\n  cropShape: 'rect',\n  showGrid: true,\n  style: {},\n  classes: {},\n  mediaProps: {},\n  zoomSpeed: 1,\n  crossOrigin: undefined,\n  restrictPosition: true,\n  onInteractionStart: function onInteractionStart() {},\n  onInteractionEnd: function onInteractionEnd() {}\n};\nvar _default = Cropper;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}