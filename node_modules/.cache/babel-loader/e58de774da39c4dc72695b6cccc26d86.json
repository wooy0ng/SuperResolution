{"ast":null,"code":"import _toConsumableArray from\"/home/ec2-user/Gwan/super-resolution/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/home/ec2-user/Gwan/super-resolution/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/ec2-user/Gwan/super-resolution/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/ec2-user/Gwan/super-resolution/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/ec2-user/Gwan/super-resolution/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,useEffect,useRef}from\"react\";import\"bootstrap/dist/css/bootstrap.min.css\";import Form from\"react-bootstrap/Form\";import\"./App.css\";import{Container,Navbar,Button}from\"react-bootstrap\";import{withCookies,Cookies}from\"react-cookie\";import HiddenCropper from\"react-bootstrap-image-cropper/dist/HiddenCropper\";import ReactCrop from\"react-image-crop\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.id=0;_this.name=\"\";_this.prev_img=\"\";_this.result=\"\";_this.inputRef=/*#__PURE__*/React.createRef();_this.downloadRef=/*#__PURE__*/React.createRef();_this.downloadRefs=[];_this.state={imgs:[],param:50,results:[],loading_flag:false};// https://sirong.tistory.com/101 : 쿠키\n// https://koreanred.tistory.com/112 : 쿠키\n_this.handleRemove=function(id){var filtered=_this.state.imgs.filter(function(obj){return obj.id!==id;});console.log(filtered);// this.result = \"\";\n_this.setState({imgs:filtered});_this.setState({results:[]});var results=[];for(var idx=0;idx<filtered.length;idx++){results.push(filtered[idx].result);}_this.result=results[results.length-1];_this.setState({results:results});console.log(_this.state);};_this.handleSubmit=function(event){var send_data=Object.assign({},_this.state);if(send_data.imgs.length>0){_this.setState({loading_flag:true});fetch(\"train\",{method:\"POST\",headers:{\"content-type\":\"application/json\"},body:JSON.stringify(send_data)}).then(function(res){return res.json();}).then(function(res){console.log(res);_this.setState({imgs:res.data,loading_flag:false});if(_this.state.results.length>0){_this.setState({results:[]});}var results=[];for(var idx=0;idx<_this.state.imgs.length;idx++){results.push(_this.state.imgs[idx].result);}_this.result=results[results.length-1];_this.setState({results:results});});}else{alert(\"please load images!!!\");}};_this.handleRefClicked=function(){console.log(_this.downloadRefs);for(var idx=0;idx<_this.state.results.length;idx++){_this.downloadRefs[idx].current.click();}};// type : blob\n_this.handleCropped=function(blob){var idx=-1;if(_this.state.imgs.length>0){idx=_this.state.imgs[_this.state.imgs.length-1].id;}console.log(\"blob : \",blob);var reader=new FileReader();reader.readAsDataURL(blob);reader.onloadend=function(event){console.log(event);var base64data=reader.result;_this.setState({imgs:[].concat(_toConsumableArray(_this.state.imgs),[{id:idx+1,name:\"\".concat(idx+1,\".jpeg\"),data:base64data,result:\"\"}])});};};return _this;}_createClass(App,[{key:\"makeDownLoadRefs\",value:function makeDownLoadRefs(){for(var idx=0;idx<this.state.results.length;idx++){this.downloadRefs[idx]=/*#__PURE__*/React.createRef();}}},{key:\"render\",value:function render(){var _this2=this;this.makeDownLoadRefs();console.log(this.state);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"nav-bar\",children:/*#__PURE__*/_jsx(Navbar,{expand:\"sm\",variant:\"light\",bg:\"light\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Navbar.Brand,{href:\"#\",children:\"Sample\"})})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-flex main-margin padding-top-60\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"img-container\",children:[this.state.results.length!==0&&this.state.results.map(function(result,idx){return/*#__PURE__*/_jsx(\"a\",{href:result,ref:_this2.downloadRefs[idx],download:idx,hidden:true});}),/*#__PURE__*/_jsx(\"div\",{className:\"result-img margin-left-20 margin-top-20 margin-right-20\",style:{background:\"url(\".concat(this.state.imgs.length>0&&this.result,\") center/cover no-repeat\")},children:/*#__PURE__*/_jsx(\"div\",{className:\"prev-img-gallary margin-top-10 margin-left-20\",children:this.state.imgs.map(function(imgs,idx){return/*#__PURE__*/_jsxs(\"div\",{className:\"container-block\",children:[/*#__PURE__*/_jsx(\"img\",{src:imgs.data,alt:\"\",className:\"prev-img-box\",onClick:function onClick(){if(imgs.result!==\"\"){_this2.id=idx;_this2.name=imgs.name;_this2.prev_img=imgs.data;_this2.result=imgs.result;}_this2.setState({imgs:_toConsumableArray(_this2.state.imgs)});}}),/*#__PURE__*/_jsx(\"div\",{className:\"cancel-btn\",onClick:function onClick(){_this2.handleRemove(imgs.id);},children:\"-\"})]},idx);})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-container padding-top-30 padding-left-70\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-title\",children:\"Super Resolution Tool\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"the super Resolution Tool uses Deep Learning to clarify, sharpen, and upscale\",/*#__PURE__*/_jsx(\"br\",{}),\"the photo without losing its content and defining characteristics.\",/*#__PURE__*/_jsx(\"br\",{}),\"Super Resolution uses Deep Learning techniques to upscale images in a fraction of a second.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container-flex flex-direction-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"padding-top-30\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"container-flex\",children:/*#__PURE__*/_jsxs(Form.Label,{children:[\" \\u03B1 : (\",this.state.param,\")\"]})}),/*#__PURE__*/_jsx(Form.Range,{tooltip:\"on\",onChange:function onChange(event){_this2.setState({param:event.target.value});}})]}),/*#__PURE__*/_jsx(HiddenCropper,{triggerRef:this.inputRef,onCropped:this.handleCropped,inputOptions:{mimeType:\"image/jpeg\"},cropOptions:{aspect:4/4,maxZoom:10},outputOptions:{maxWidth:256,maxHeight:256},previewOptions:{width:256,height:256},displayOptions:{title:\"Cropping\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"container-flex margin-top-20\",children:[/*#__PURE__*/_jsx(Button,{className:\"btn-size\",variant:\"outline-secondary\",onClick:function onClick(){if(_this2.state.imgs.length<1){// this.inputRef.current.click();\n_this2.inputRef.current.trigger();}else{alert(\"error\");}},children:\"Load image\"}),!this.state.loading_flag?/*#__PURE__*/_jsx(Button,{className:\"btn-size margin-left-20\",variant:\"outline-primary\",onClick:function onClick(){_this2.handleSubmit();},children:\"training\"}):/*#__PURE__*/_jsxs(\"button\",{class:\"btn-size margin-left-20 btn btn-primary\",type:\"button\",disabled:true,children:[/*#__PURE__*/_jsx(\"span\",{class:\"spinner-border spinner-border-sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"\\xA0 Loading...\"]}),/*#__PURE__*/_jsx(Button,{className:\"btn-size margin-left-20\",variant:\"outline-primary\",disabled:this.state.results.length===0,onClick:function onClick(){_this2.handleRefClicked();},children:\"Download\"})]})]})]})]})})]});}}]);return App;}(Component);export default withCookies(App);","map":{"version":3,"sources":["/home/ec2-user/Gwan/super-resolution/src/App.js"],"names":["React","Component","useEffect","useRef","Form","Container","Navbar","Button","withCookies","Cookies","HiddenCropper","ReactCrop","App","props","id","name","prev_img","result","inputRef","createRef","downloadRef","downloadRefs","state","imgs","param","results","loading_flag","handleRemove","filtered","filter","obj","console","log","setState","idx","length","push","handleSubmit","event","send_data","Object","assign","fetch","method","headers","body","JSON","stringify","then","res","json","data","alert","handleRefClicked","current","click","handleCropped","blob","reader","FileReader","readAsDataURL","onloadend","base64data","makeDownLoadRefs","map","background","target","value","mimeType","aspect","maxZoom","maxWidth","maxHeight","width","height","title","trigger"],"mappings":"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","sourcesContent":["import React, { Component, useEffect, useRef } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Form from \"react-bootstrap/Form\";\nimport \"./App.css\";\nimport { Container, Navbar, Button } from \"react-bootstrap\";\nimport { withCookies, Cookies } from \"react-cookie\";\nimport { instanceOf } from \"prop-types\";\nimport HiddenCropper from \"react-bootstrap-image-cropper/dist/HiddenCropper\";\nimport ReactCrop from \"react-image-crop\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.id = 0;\n    this.name = \"\";\n    this.prev_img = \"\";\n    this.result = \"\";\n\n    this.inputRef = React.createRef();\n    this.downloadRef = React.createRef();\n    this.downloadRefs = [];\n\n    this.state = {\n      imgs: [],\n      param: 50,\n      results: [],\n      loading_flag: false,\n    };\n\n    // https://sirong.tistory.com/101 : 쿠키\n    // https://koreanred.tistory.com/112 : 쿠키\n\n    this.handleRemove = (id) => {\n      const filtered = this.state.imgs.filter((obj) => obj.id !== id);\n      console.log(filtered);\n\n      // this.result = \"\";\n      this.setState({ imgs: filtered });\n\n      this.setState({\n        results: [],\n      });\n      let results = [];\n      for (let idx = 0; idx < filtered.length; idx++) {\n        results.push(filtered[idx].result);\n      }\n      this.result = results[results.length - 1];\n      this.setState({ results: results });\n      console.log(this.state);\n    };\n\n    this.handleSubmit = (event) => {\n      const send_data = Object.assign({}, this.state);\n      if (send_data.imgs.length > 0) {\n        this.setState({\n          loading_flag: true,\n        });\n        fetch(\"train\", {\n          method: \"POST\",\n          headers: { \"content-type\": \"application/json\" },\n          body: JSON.stringify(send_data),\n        })\n          .then((res) => res.json())\n          .then((res) => {\n            console.log(res);\n            this.setState({\n              imgs: res.data,\n              loading_flag: false,\n            });\n\n            if (this.state.results.length > 0) {\n              this.setState({\n                results: [],\n              });\n            }\n            let results = [];\n            for (let idx = 0; idx < this.state.imgs.length; idx++) {\n              results.push(this.state.imgs[idx].result);\n            }\n            this.result = results[results.length - 1];\n            this.setState({ results: results });\n          });\n      } else {\n        alert(\"please load images!!!\");\n      }\n    };\n    this.handleRefClicked = () => {\n      console.log(this.downloadRefs);\n      for (let idx = 0; idx < this.state.results.length; idx++) {\n        this.downloadRefs[idx].current.click();\n      }\n    };\n    // type : blob\n    this.handleCropped = (blob) => {\n      let idx = -1;\n      if (this.state.imgs.length > 0) {\n        idx = this.state.imgs[this.state.imgs.length - 1].id;\n      }\n\n      console.log(\"blob : \", blob);\n      const reader = new FileReader();\n      reader.readAsDataURL(blob);\n      reader.onloadend = (event) => {\n        console.log(event);\n        let base64data = reader.result;\n\n        this.setState({\n          imgs: [\n            ...this.state.imgs,\n            {\n              id: idx + 1,\n              name: `${idx + 1}.jpeg`,\n              data: base64data,\n              result: \"\",\n            },\n          ],\n        });\n      };\n    };\n  }\n  makeDownLoadRefs() {\n    for (let idx = 0; idx < this.state.results.length; idx++) {\n      this.downloadRefs[idx] = React.createRef();\n    }\n  }\n\n  render() {\n    this.makeDownLoadRefs();\n    console.log(this.state);\n    return (\n      <div>\n        <div className=\"header\">\n          <div className=\"nav-bar\">\n            <Navbar expand=\"sm\" variant=\"light\" bg=\"light\">\n              <Container>\n                <Navbar.Brand href=\"#\">Sample</Navbar.Brand>\n              </Container>\n            </Navbar>\n          </div>\n        </div>\n\n        <div className=\"body\">\n          <div className=\"container-flex main-margin padding-top-60\">\n            <div className=\"img-container\">\n              {this.state.results.length !== 0 &&\n                this.state.results.map((result, idx) => (\n                  <a\n                    href={result}\n                    ref={this.downloadRefs[idx]}\n                    download={idx}\n                    hidden\n                  ></a>\n                ))}\n              <div\n                className=\"result-img margin-left-20 margin-top-20 margin-right-20\"\n                style={{\n                  background: `url(${\n                    this.state.imgs.length > 0 && this.result\n                  }) center/cover no-repeat`,\n                }}\n              >\n                <div className=\"prev-img-gallary margin-top-10 margin-left-20\">\n                  {this.state.imgs.map((imgs, idx) => (\n                    <div className=\"container-block\" key={idx}>\n                      <img\n                        src={imgs.data}\n                        alt=\"\"\n                        className=\"prev-img-box\"\n                        onClick={() => {\n                          if (imgs.result !== \"\") {\n                            this.id = idx;\n                            this.name = imgs.name;\n                            this.prev_img = imgs.data;\n                            this.result = imgs.result;\n                          }\n\n                          this.setState({ imgs: [...this.state.imgs] });\n                        }}\n                      />\n                      <div\n                        className=\"cancel-btn\"\n                        onClick={() => {\n                          this.handleRemove(imgs.id);\n                        }}\n                      >\n                        -\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n            <div className=\"text-container padding-top-30 padding-left-70\">\n              <p className=\"font-title\">Super Resolution Tool</p>\n              <p>\n                the super Resolution Tool uses Deep Learning to clarify,\n                sharpen, and upscale\n                <br />\n                the photo without losing its content and defining\n                characteristics.\n                <br />\n                Super Resolution uses Deep Learning techniques to upscale images\n                in a fraction of a second.\n              </p>\n              <div className=\"container-flex flex-direction-col\">\n                <div className=\"padding-top-30\">\n                  {/* param */}\n                  <div className=\"container-flex\">\n                    <Form.Label> α : ({this.state.param})</Form.Label>\n                  </div>\n                  <Form.Range\n                    tooltip=\"on\"\n                    onChange={(event) => {\n                      this.setState({ param: event.target.value });\n                    }}\n                  />\n                </div>\n                {/* cropping test 1 */}\n                <HiddenCropper\n                  triggerRef={this.inputRef}\n                  onCropped={this.handleCropped}\n                  inputOptions={{ mimeType: \"image/jpeg\" }}\n                  cropOptions={{ aspect: 4 / 4, maxZoom: 10 }}\n                  outputOptions={{ maxWidth: 256, maxHeight: 256 }}\n                  previewOptions={{ width: 256, height: 256 }}\n                  displayOptions={{ title: \"Cropping\" }}\n                />\n                {/* cropping test 2 */}\n                {/* \n                <input\n                  type=\"file\"\n                  ref={this.inputRef}\n                  onChange={(event) => {\n                    console.log(\"input files\");\n                    if (event.currentTarget.files.length > 0) {\n                      const file = event.currentTarget.files[0];\n\n                      // file read\n                      const reader = new FileReader();\n                      reader.readAsDataURL(file);\n                      reader.onloadend = (event) => {\n                        let idx = -1;\n                        if (this.state.imgs.length > 0) {\n                          idx = this.state.imgs[this.state.imgs.length - 1].id;\n                        }\n\n                        this.setState({\n                          imgs: [\n                            ...this.state.imgs,\n                            {\n                              id: idx + 1,\n                              name: file.name,\n                              data: event.target.result,\n                              result: \"\",\n                            },\n                          ],\n                        });\n                      };\n                    }\n                    event.target.value = \"\";\n                  }}\n                  hidden\n                /> */}\n\n                {/* button area */}\n                <div className=\"container-flex margin-top-20\">\n                  <Button\n                    className=\"btn-size\"\n                    variant=\"outline-secondary\"\n                    onClick={() => {\n                      if (this.state.imgs.length < 1) {\n                        // this.inputRef.current.click();\n                        this.inputRef.current.trigger();\n                      } else {\n                        alert(\"error\");\n                      }\n                    }}\n                  >\n                    Load image\n                  </Button>\n                  {!this.state.loading_flag ? (\n                    <Button\n                      className=\"btn-size margin-left-20\"\n                      variant=\"outline-primary\"\n                      onClick={() => {\n                        this.handleSubmit();\n                      }}\n                    >\n                      training\n                    </Button>\n                  ) : (\n                    <button\n                      class=\"btn-size margin-left-20 btn btn-primary\"\n                      type=\"button\"\n                      disabled\n                    >\n                      <span\n                        class=\"spinner-border spinner-border-sm\"\n                        role=\"status\"\n                        aria-hidden=\"true\"\n                      ></span>\n                      &nbsp; Loading...\n                    </button>\n                  )}\n\n                  <Button\n                    className=\"btn-size margin-left-20\"\n                    variant=\"outline-primary\"\n                    disabled={this.state.results.length === 0}\n                    onClick={() => {\n                      this.handleRefClicked();\n                    }}\n                  >\n                    Download\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withCookies(App);\n"]},"metadata":{},"sourceType":"module"}