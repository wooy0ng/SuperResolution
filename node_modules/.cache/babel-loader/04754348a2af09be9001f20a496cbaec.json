{"ast":null,"code":"var _jsxFileName = \"/usr/app/src/App.js\";\nimport React, { Component, useEffect, useRef } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Form from \"react-bootstrap/Form\";\nimport \"./App.css\";\nimport { Container, Navbar, Button } from \"react-bootstrap\";\nimport { withCookies, Cookies } from \"react-cookie\";\nimport { instanceOf } from \"prop-types\";\nimport HiddenCropper from \"react-bootstrap-image-cropper/dist/HiddenCropper\";\nimport ReactCrop from \"react-image-crop\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.id = 0;\n    this.name = \"\";\n    this.prev_img = \"\";\n    this.result = \"\";\n    this.inputRef = /*#__PURE__*/React.createRef();\n    this.downloadRef = /*#__PURE__*/React.createRef();\n    this.downloadRefs = [];\n    this.state = {\n      imgs: [],\n      param: 50,\n      results: [],\n      loading_flag: false\n    }; // https://sirong.tistory.com/101 : 쿠키\n    // https://koreanred.tistory.com/112 : 쿠키\n\n    this.handleRemove = id => {\n      const filtered = this.state.imgs.filter(obj => obj.id !== id);\n      console.log(filtered); // this.result = \"\";\n\n      this.setState({\n        imgs: filtered\n      });\n      this.setState({\n        results: []\n      });\n      let results = [];\n\n      for (let idx = 0; idx < filtered.length; idx++) {\n        results.push(filtered[idx].result);\n      }\n\n      this.result = results[results.length - 1];\n      this.setState({\n        results: results\n      });\n      console.log(this.state);\n    };\n\n    this.handleSubmit = event => {\n      const send_data = Object.assign({}, this.state);\n\n      if (send_data.imgs.length > 0) {\n        this.setState({\n          loading_flag: true\n        });\n        fetch(\"train\", {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/json\"\n          },\n          body: JSON.stringify(send_data)\n        }).then(res => res.json()).then(res => {\n          console.log(res);\n          this.setState({\n            imgs: res.data,\n            loading_flag: false\n          });\n\n          if (this.state.results.length > 0) {\n            this.setState({\n              results: []\n            });\n          }\n\n          let results = [];\n\n          for (let idx = 0; idx < this.state.imgs.length; idx++) {\n            results.push(this.state.imgs[idx].result);\n          }\n\n          this.result = results[results.length - 1];\n          this.setState({\n            results: results\n          });\n        });\n      } else {\n        alert(\"please load images!!!\");\n      }\n    };\n\n    this.handleRefClicked = () => {\n      console.log(this.downloadRefs);\n\n      for (let idx = 0; idx < this.state.results.length; idx++) {\n        this.downloadRefs[idx].current.click();\n      }\n    }; // type : blob\n\n\n    this.handleCropped = blob => {\n      let idx = -1;\n\n      if (this.state.imgs.length > 0) {\n        idx = this.state.imgs[this.state.imgs.length - 1].id;\n      }\n\n      console.log(\"blob : \", blob);\n      const reader = new FileReader();\n      reader.readAsDataURL(blob);\n\n      reader.onloadend = event => {\n        console.log(event);\n        let base64data = reader.result;\n        this.setState({\n          imgs: [...this.state.imgs, {\n            id: idx + 1,\n            name: `${idx + 1}.jpeg`,\n            data: base64data,\n            result: \"\"\n          }]\n        });\n      };\n    };\n  }\n\n  makeDownLoadRefs() {\n    for (let idx = 0; idx < this.state.results.length; idx++) {\n      this.downloadRefs[idx] = /*#__PURE__*/React.createRef();\n    }\n  }\n\n  render() {\n    this.makeDownLoadRefs();\n    console.log(this.state);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"nav-bar\",\n          children: /*#__PURE__*/_jsxDEV(Navbar, {\n            expand: \"sm\",\n            variant: \"light\",\n            bg: \"light\",\n            children: /*#__PURE__*/_jsxDEV(Container, {\n              children: /*#__PURE__*/_jsxDEV(Navbar.Brand, {\n                href: \"#\",\n                children: \"Super Resolution Tool\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container-flex main-margin padding-top-60\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"img-container margin-left-80\",\n            children: [this.state.results.length !== 0 && this.state.results.map((result, idx) => /*#__PURE__*/_jsxDEV(\"a\", {\n              href: result,\n              ref: this.downloadRefs[idx],\n              download: idx,\n              hidden: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"result-img margin-left-20 margin-top-20 margin-right-20\",\n              style: {\n                background: `url(${this.state.imgs.length > 0 && this.result}) center/cover no-repeat`\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prev-img-gallary margin-top-10 margin-left-20\",\n                children: this.state.imgs.map((imgs, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"container-block\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: imgs.data,\n                    alt: \"\",\n                    className: \"prev-img-box\",\n                    onClick: () => {\n                      if (imgs.result !== \"\") {\n                        this.id = idx;\n                        this.name = imgs.name;\n                        this.prev_img = imgs.data;\n                        this.result = imgs.result;\n                      }\n\n                      this.setState({\n                        imgs: [...this.state.imgs]\n                      });\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"cancel-btn\",\n                    onClick: () => {\n                      this.handleRemove(imgs.id);\n                    },\n                    children: \"-\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 180,\n                    columnNumber: 23\n                  }, this)]\n                }, idx, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 21\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-container padding-top-30 padding-left-70\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-title\",\n                children: \"Super Resolution Tool\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"the super Resolution Tool uses Deep Learning to clarify, sharpen, and upscale\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 17\n              }, this), \"the photo without losing its content and defining characteristics.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 17\n              }, this), \"Super Resolution uses Deep Learning techniques to upscale images in a fraction of a second.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"container-flex flex-direction-col margin-top-50\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"padding-top-30\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(HiddenCropper, {\n                triggerRef: this.inputRef,\n                onCropped: this.handleCropped,\n                inputOptions: {\n                  mimeType: \"image/jpeg\"\n                },\n                cropOptions: {\n                  aspect: 4 / 4,\n                  maxZoom: 10\n                },\n                outputOptions: {\n                  maxWidth: 256,\n                  maxHeight: 256\n                },\n                previewOptions: {\n                  width: 256,\n                  height: 256\n                },\n                displayOptions: {\n                  title: \"Cropping\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"container-flex\",\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn-size\",\n                  variant: \"outline-secondary\",\n                  onClick: () => {\n                    if (this.state.imgs.length < 1) {\n                      // this.inputRef.current.click();\n                      this.inputRef.current.trigger();\n                    } else {\n                      alert(\"이전 사진을 제거하고 넣어주세요.\");\n                    }\n                  },\n                  children: \"Load image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn-size margin-left-20\",\n                  variant: \"outline-secondary\",\n                  disabled: this.state.imgs.length === 0,\n                  onClick: () => {\n                    this.result = \"\";\n                    this.setState({\n                      imgs: [],\n                      results: []\n                    });\n                    console.log(this.state);\n                  },\n                  children: \"Clear\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 19\n                }, this), !this.state.loading_flag ? /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn-size margin-left-20\",\n                  disabled: this.state.imgs.length === 0,\n                  variant: \"outline-primary\",\n                  onClick: () => {\n                    this.handleSubmit();\n                  },\n                  children: \"Get SR image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  class: \"btn-size margin-left-20 btn btn-primary\",\n                  type: \"button\",\n                  disabled: true,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    class: \"spinner-border spinner-border-sm\",\n                    role: \"status\",\n                    \"aria-hidden\": \"true\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 23\n                  }, this), \"\\xA0 Loading...\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn-size margin-left-20\",\n                  variant: \"outline-primary\",\n                  disabled: this.state.results.length === 0,\n                  onClick: () => {\n                    this.handleRefClicked();\n                  },\n                  children: \"Download\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c = withCookies(App);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/usr/app/src/App.js"],"names":["React","Component","useEffect","useRef","Form","Container","Navbar","Button","withCookies","Cookies","instanceOf","HiddenCropper","ReactCrop","App","constructor","props","id","name","prev_img","result","inputRef","createRef","downloadRef","downloadRefs","state","imgs","param","results","loading_flag","handleRemove","filtered","filter","obj","console","log","setState","idx","length","push","handleSubmit","event","send_data","Object","assign","fetch","method","headers","body","JSON","stringify","then","res","json","data","alert","handleRefClicked","current","click","handleCropped","blob","reader","FileReader","readAsDataURL","onloadend","base64data","makeDownLoadRefs","render","map","background","mimeType","aspect","maxZoom","maxWidth","maxHeight","width","height","title","trigger"],"mappings":"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","sourcesContent":["import React, { Component, useEffect, useRef } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Form from \"react-bootstrap/Form\";\nimport \"./App.css\";\nimport { Container, Navbar, Button } from \"react-bootstrap\";\nimport { withCookies, Cookies } from \"react-cookie\";\nimport { instanceOf } from \"prop-types\";\nimport HiddenCropper from \"react-bootstrap-image-cropper/dist/HiddenCropper\";\nimport ReactCrop from \"react-image-crop\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.id = 0;\n    this.name = \"\";\n    this.prev_img = \"\";\n    this.result = \"\";\n\n    this.inputRef = React.createRef();\n    this.downloadRef = React.createRef();\n    this.downloadRefs = [];\n\n    this.state = {\n      imgs: [],\n      param: 50,\n      results: [],\n      loading_flag: false,\n    };\n\n    // https://sirong.tistory.com/101 : 쿠키\n    // https://koreanred.tistory.com/112 : 쿠키\n\n    this.handleRemove = (id) => {\n      const filtered = this.state.imgs.filter((obj) => obj.id !== id);\n      console.log(filtered);\n\n      // this.result = \"\";\n      this.setState({ imgs: filtered });\n\n      this.setState({\n        results: [],\n      });\n      let results = [];\n      for (let idx = 0; idx < filtered.length; idx++) {\n        results.push(filtered[idx].result);\n      }\n      this.result = results[results.length - 1];\n      this.setState({ results: results });\n      console.log(this.state);\n    };\n\n    this.handleSubmit = (event) => {\n      const send_data = Object.assign({}, this.state);\n      if (send_data.imgs.length > 0) {\n        this.setState({\n          loading_flag: true,\n        });\n        fetch(\"train\", {\n          method: \"POST\",\n          headers: { \"content-type\": \"application/json\" },\n          body: JSON.stringify(send_data),\n        })\n          .then((res) => res.json())\n          .then((res) => {\n            console.log(res);\n            this.setState({\n              imgs: res.data,\n              loading_flag: false,\n            });\n\n            if (this.state.results.length > 0) {\n              this.setState({\n                results: [],\n              });\n            }\n            let results = [];\n            for (let idx = 0; idx < this.state.imgs.length; idx++) {\n              results.push(this.state.imgs[idx].result);\n            }\n            this.result = results[results.length - 1];\n            this.setState({ results: results });\n          });\n      } else {\n        alert(\"please load images!!!\");\n      }\n    };\n    this.handleRefClicked = () => {\n      console.log(this.downloadRefs);\n      for (let idx = 0; idx < this.state.results.length; idx++) {\n        this.downloadRefs[idx].current.click();\n      }\n    };\n    // type : blob\n    this.handleCropped = (blob) => {\n      let idx = -1;\n      if (this.state.imgs.length > 0) {\n        idx = this.state.imgs[this.state.imgs.length - 1].id;\n      }\n\n      console.log(\"blob : \", blob);\n      const reader = new FileReader();\n      reader.readAsDataURL(blob);\n      reader.onloadend = (event) => {\n        console.log(event);\n        let base64data = reader.result;\n\n        this.setState({\n          imgs: [\n            ...this.state.imgs,\n            {\n              id: idx + 1,\n              name: `${idx + 1}.jpeg`,\n              data: base64data,\n              result: \"\",\n            },\n          ],\n        });\n      };\n    };\n  }\n  makeDownLoadRefs() {\n    for (let idx = 0; idx < this.state.results.length; idx++) {\n      this.downloadRefs[idx] = React.createRef();\n    }\n  }\n\n  render() {\n    this.makeDownLoadRefs();\n    console.log(this.state);\n    return (\n      <div>\n        <div className=\"header\">\n          <div className=\"nav-bar\">\n            <Navbar expand=\"sm\" variant=\"light\" bg=\"light\">\n              <Container>\n                <Navbar.Brand href=\"#\">Super Resolution Tool</Navbar.Brand>\n              </Container>\n            </Navbar>\n          </div>\n        </div>\n\n        <div className=\"body\">\n          <div className=\"container-flex main-margin padding-top-60\">\n            <div className=\"img-container margin-left-80\">\n              {this.state.results.length !== 0 &&\n                this.state.results.map((result, idx) => (\n                  <a\n                    href={result}\n                    ref={this.downloadRefs[idx]}\n                    download={idx}\n                    hidden\n                  ></a>\n                ))}\n              <div\n                className=\"result-img margin-left-20 margin-top-20 margin-right-20\"\n                style={{\n                  background: `url(${\n                    this.state.imgs.length > 0 && this.result\n                  }) center/cover no-repeat`,\n                }}\n              >\n                <div className=\"prev-img-gallary margin-top-10 margin-left-20\">\n                  {this.state.imgs.map((imgs, idx) => (\n                    <div className=\"container-block\" key={idx}>\n                      <img\n                        src={imgs.data}\n                        alt=\"\"\n                        className=\"prev-img-box\"\n                        onClick={() => {\n                          if (imgs.result !== \"\") {\n                            this.id = idx;\n                            this.name = imgs.name;\n                            this.prev_img = imgs.data;\n                            this.result = imgs.result;\n                          }\n\n                          this.setState({ imgs: [...this.state.imgs] });\n                        }}\n                      />\n                      <div\n                        className=\"cancel-btn\"\n                        onClick={() => {\n                          this.handleRemove(imgs.id);\n                        }}\n                      >\n                        -\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n            <div className=\"text-container padding-top-30 padding-left-70\">\n              <div className=\"\">\n                <p className=\"font-title\">Super Resolution Tool</p>\n              </div>\n              <p>\n                the super Resolution Tool uses Deep Learning to clarify,\n                sharpen, and upscale\n                <br />\n                the photo without losing its content and defining\n                characteristics.\n                <br />\n                Super Resolution uses Deep Learning techniques to upscale images\n                in a fraction of a second.\n              </p>\n              <div className=\"container-flex flex-direction-col margin-top-50\">\n                <div className=\"padding-top-30\">\n                  {/* param */}\n                  {/* <div className=\"container-flex\">\n                    <Form.Label> α : ({this.state.param})</Form.Label>\n                  </div>\n                  <Form.Range\n                    tooltip=\"on\"\n                    onChange={(event) => {\n                      this.setState({ param: event.target.value });\n                    }}\n                  /> */}\n                </div>\n                {/* cropping test 1 */}\n                <HiddenCropper\n                  triggerRef={this.inputRef}\n                  onCropped={this.handleCropped}\n                  inputOptions={{ mimeType: \"image/jpeg\" }}\n                  cropOptions={{ aspect: 4 / 4, maxZoom: 10 }}\n                  outputOptions={{ maxWidth: 256, maxHeight: 256 }}\n                  previewOptions={{ width: 256, height: 256 }}\n                  displayOptions={{ title: \"Cropping\" }}\n                />\n                {/* cropping test 2 */}\n                {/* \n                <input\n                  type=\"file\"\n                  ref={this.inputRef}\n                  onChange={(event) => {\n                    console.log(\"input files\");\n                    if (event.currentTarget.files.length > 0) {\n                      const file = event.currentTarget.files[0];\n\n                      // file read\n                      const reader = new FileReader();\n                      reader.readAsDataURL(file);\n                      reader.onloadend = (event) => {\n                        let idx = -1;\n                        if (this.state.imgs.length > 0) {\n                          idx = this.state.imgs[this.state.imgs.length - 1].id;\n                        }\n\n                        this.setState({\n                          imgs: [\n                            ...this.state.imgs,\n                            {\n                              id: idx + 1,\n                              name: file.name,\n                              data: event.target.result,\n                              result: \"\",\n                            },\n                          ],\n                        });\n                      };\n                    }\n                    event.target.value = \"\";\n                  }}\n                  hidden\n                /> */}\n\n                {/* button area */}\n                <div className=\"container-flex\">\n                  <Button\n                    className=\"btn-size\"\n                    variant=\"outline-secondary\"\n                    onClick={() => {\n                      if (this.state.imgs.length < 1) {\n                        // this.inputRef.current.click();\n                        this.inputRef.current.trigger();\n                      } else {\n                        alert(\"이전 사진을 제거하고 넣어주세요.\");\n                      }\n                    }}\n                  >\n                    Load image\n                  </Button>\n                  <Button\n                    className=\"btn-size margin-left-20\"\n                    variant=\"outline-secondary\"\n                    disabled={this.state.imgs.length === 0}\n                    onClick={() => {\n                      this.result = \"\";\n                      this.setState({\n                        imgs: [],\n                        results: [],\n                      });\n                      console.log(this.state);\n                    }}\n                  >\n                    Clear\n                  </Button>\n                  {!this.state.loading_flag ? (\n                    <Button\n                      className=\"btn-size margin-left-20\"\n                      disabled={this.state.imgs.length === 0}\n                      variant=\"outline-primary\"\n                      onClick={() => {\n                        this.handleSubmit();\n                      }}\n                    >\n                      Get SR image\n                    </Button>\n                  ) : (\n                    <button\n                      class=\"btn-size margin-left-20 btn btn-primary\"\n                      type=\"button\"\n                      disabled\n                    >\n                      <span\n                        class=\"spinner-border spinner-border-sm\"\n                        role=\"status\"\n                        aria-hidden=\"true\"\n                      ></span>\n                      &nbsp; Loading...\n                    </button>\n                  )}\n\n                  <Button\n                    className=\"btn-size margin-left-20\"\n                    variant=\"outline-primary\"\n                    disabled={this.state.results.length === 0}\n                    onClick={() => {\n                      this.handleRefClicked();\n                    }}\n                  >\n                    Download\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withCookies(App);\n"]},"metadata":{},"sourceType":"module"}